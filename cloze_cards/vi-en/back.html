<span class="front">{{Front}}</span>

<br /><br />

<div class="examplesDiv">Ví dụ: <span id="examples">{{Examples}}</span></div>

<br />

<span id="back">{{Back}}</span>

<br /><br />
<a
  href="https://www.perplexity.ai/search?q=Explain%20the%20meaning%20of%20the%20vietnamese%20word%20%22{{Front}}%22%20and%20give%20some%20examples%20and%20common%20phrases%20for%20its%20usage."
  class="wikt_data"
  ,
  style="display: inline-flex; align-items: center; justify-content: center"
>
  <!-- Perplexity Icon -->
  <img
    src="data:image/png;base64,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"
    alt="Perplexity Logo"
    style="margin-right: 5px"
  />
  Explain with Perplexity</a
>

<script>
  function createDetails(summary, contentElement) {
    const details = document.createElement("details");
    const summaryElement = document.createElement("summary");
    summaryElement.innerHTML = summary;
    details.appendChild(summaryElement);

    if (!contentElement) {
      return details;
    }

    if (typeof contentElement === "string") {
      const content = document.createElement("p");
      content.innerHTML = contentElement;
      details.appendChild(content);
    } else {
      details.appendChild(contentElement);
    }

    return details;
  }

  // Function to choose a random example
  function chooseRandomExample() {
    const examplesDom = document.getElementById("examples");
    var text = examplesDom.innerHTML;
    var examples = text.replace(/\\/g, "").split("|");
    const randomIndex = sessionStorage.getItem("viex_curIdx");

    const exDetails = createDetails(
      examples[randomIndex],
      examples.join("<br>"),
    );
    text = exDetails.outerHTML;
    examplesDom.innerHTML = text;
  }

  function fillWiktData(wikt_data) {
    console.log(wikt_data);
    if (!wikt_data) {
      return;
    }
    const data = JSON.parse(wikt_data);
    const wiktDataParent = document.createElement("div");
    wiktDataParent.classList.add("wikt_data");

    // Dynamically create the wikt entries
    data.forEach(function (entry) {
      const wiktEntry = document.createElement("div");
      wiktEntry.classList.add("wikt_entry");

      const pos = entry.pos + ": ";

      let synonyms;
      if ("synonyms" in entry) {
        const synonymsText = entry.synonyms.join(", ");
        synonyms = createDetails("Synonyms", synonymsText);
        synonyms.classList.add("wikt_extra");
      }

      let etymology;
      if ("etymology" in entry) {
        const etymologyText = entry.etymology;
        etymology = createDetails("Etymology", etymologyText);
        etymology.classList.add("wikt_extra");
      }

      entry.meanings.forEach(function (meaning) {
        const meaningText = pos + meaning.meaning;
        const hasExtraInfo = "examples" in meaning || etymology || synonyms;

        let meaningElem;
        if (!hasExtraInfo) {
          meaningElem = document.createElement("div");
          meaningElem.classList.add("wikt_meaning");
          meaningElem.innerHTML = meaningText;
        } else {
          meaningElem = createDetails(meaningText);
          meaningElem.classList.add("wikt_meaning");
        }

        wiktEntry.appendChild(meaningElem);

        if (meaning.examples) {
          const examplesDiv = createDetails(
            "Examples",
            meaning.examples.join(" | "),
          );
          examplesDiv.classList.add("wikt_extra");
          meaningElem.appendChild(examplesDiv);
        }

        if (synonyms) {
          meaningElem.appendChild(synonyms.cloneNode(true));
        }

        if (etymology) {
          meaningElem.appendChild(etymology.cloneNode(true));
        }
      });

      wiktDataParent.appendChild(wiktEntry);
    });

    document.getElementById("back").innerHTML = "";
    document.getElementById("back").appendChild(wiktDataParent);
  }

  // Fix problem with the text being HTML encoded sometimes
  function decodeHtmlEntities(str) {
    const txt = document.createElement("textarea");
    txt.innerHTML = str;
    return txt.value;
  }

  chooseRandomExample();
  fillWiktData(decodeHtmlEntities(`{{WiktData}}`));
</script>

